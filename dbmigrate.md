# Introduction #

Excursion: [Why use dbmigrate and who can use it?](DBMigrateWhy.md)

You can use the dbmigrate tool to manage the creation and evolution of one or more databases. It supports postgres, mysql and oracle explicitly, but should run with any JDBC database. With this tool, you can set up a project with scripts (e.g. SQL) to create the database and put upgrade scripts into another directory to upgrade to a newer schema version.

Normally you write a configuration to setup the database from scratch and another configuration to upgrade to higher versions. In upgrade-mode, the tool executes all upgrade scripts that are required.

### Features ###
  * Migrate a database automatically to the current version by execution of .sql scripts or java code
  * Check an existing database for compliance against .sql scripts
  * Execute and parse SQL scripts,
> > even those generated by eclipselink (with and without ; )

### How does database migration work? ###
The AutoMigrationTool maintains a table db\_version in the database in which it stored the database version.

  1. it reads the db\_version table
  1. it scans in a preconfigured folder for migration scripts
  1. it executes all scripts, that are required to migrate the database from the current version to a target version (or the latest version possible)
  1. it update the db\_version table

### Migration scripts ###
  1. script name contains a version information:

> up\_version\_additional\_info.suffix

suffix can be:
  1. .sql
  1. .xml
  1. .groovy

version can be:
  1. a number or many numbers divided by _or . or -_

additional\_info is an optional description for the script.

examples:
up\_1\_0\_0\_initial.sql
up\_2.1.35.sql

### How does the database-schema-check work? ###
The schema-check is an optional validation step. It can be invoked separately or as a (final) part of the database migration.
The DatabaseSchemaChecker gets
  1. a JdbcDatabase with connection properties as input and
  1. a list of URLs to .sql scripts as input.
  1. it reads the database catalog and builds a CatalogDescription (1)
  1. it parses all sql-scripts and builds another CatalogDescription (2)
  1. it compares the actual catalog (1) with the expected catalog (2) and reports all differences found.

==> Thus you immediatly find any modifications in the database or inconsistencies in your schema-scripts.


## [Getting started!](GettingStartedDbMigrate.md) ##

  * GettingStartedDbMigrate
  * [Example-Project](DBMigrateExample.md): Look into the example to get an impression quickly or to use the example as a starting project for your own database.
  * [configuration and features](DBMigrateConfig.md): Look into the detailed documentation to learn the configuration and other features.
## Reference dbmigrate in maven pom.xml ##
```
  <dependency>
    <groupId>de.viaboxx</groupId>
    <artifactId>dbmigrate</artifactId>
    <version>2.5.15</version>
  </dependency>
```


# Documentation #
  * [JavaDoc ](http://agimatec-tools.googlecode.com/svn/trunk/javadoc/dbmigrate/index.html)

## AutoMigrationTool ##
![http://agimatec-tools.googlecode.com/svn/wiki/agimatec-tools-b.jpg](http://agimatec-tools.googlecode.com/svn/wiki/agimatec-tools-b.jpg)

## Other Tools (code generation, transformation) contained in dbmigrate.jar ##
![http://agimatec-tools.googlecode.com/svn/wiki/agimatec-tools-a.jpg](http://agimatec-tools.googlecode.com/svn/wiki/agimatec-tools-a.jpg)

  * InvokerTool
  * [DDLParserTool](DDLParserTool.md)
  * DbUnitDumpTool
  * DbUnitSetupTool
  * HistoryGeneratorTool
  * CatalogGeneratorTool
  * ScriptTransformatorTool